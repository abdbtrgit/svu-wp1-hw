<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title id="headTitle"></title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<link rel="stylesheet" href="assets/css/styles.css">
<script src="assets/js/main.js"></script>
<script src="assets/js/data.js"></script>
</head>
<body>
<div class="container" id="header"></div>

<div class="container" id="main">
	<div class="row">
		<div class="col"></div>
		<div class="col">
			<div class="row">
				<label for="categorySelect" class="form-label">التصنيف </label>
				<select id="categorySelect" class="form-select mb-3" style="min-width: 190px">
					<option value="">كل التصنيفات</option>
				</select>
			</div>
			<div class="row">
				<label for="locationSearchInput" class="form-label">المكان </label>
			<input type="text" id="locationSearchInput" class="form-control mb-3" placeholder="مكان الفعالية">
			</div>
			<div class="row">
				<label for="dateSearchInput" class="form-label">التاريخ </label>
				<input type="date" id="dateSearchInput" class="form-control mb-3" placeholder="تاريخ الفعالية">
			</div>
		</div>
		<div class="col"></div>
	</div>
<section class="row">
	<h2>قائمة الفعاليات</h2>
	<div  class="row row-cols-1 row-cols-md-3 g-4" id="eventsList"></div>
</section>

</div>
<div class="container" id="backToTop"></div>
<div class="container" id="footer"></div>
<script>
document.getElementById("header").innerHTML=header();
document.getElementById("footer").innerHTML=footer();
document.getElementById("backToTop").innerHTML=backToTop();
$(".nav .nav-link").removeClass("active").removeAttr("aria-current");
$(".nav .nav-link").eq(1).addClass("active").attr("aria-current", "page");
const backToTopButton = document.getElementById("btn-back-to-top");
const categorySelect = document.getElementById("categorySelect")
const dateSearchInput = document.getElementById("dateSearchInput")
const locationSearchInput = document.getElementById("locationSearchInput")
const params = new URLSearchParams(window.location.search);
const categoryURL = params.get("category");
if(typeof categoriesList != "undefined"){
	for(i=0; i < categoriesList.length; i++) {
		categorySelect.innerHTML += '<option value="'+categoriesList[i]+'">'+categoriesList[i]+'</option>'
	}
}

if(categoryURL != null)
{
	newData = createEventListByCategory(categoryURL, data.events);
	createEventList(newData)
	categorySelect.value = categoryURL
}
else
{
	createEventList(data.events)
}




  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) {
      backToTopButton.style.display = "inline-block";
    } else {
      backToTopButton.style.display = "none";
    }
  });

  backToTopButton.addEventListener("click", () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });

	categorySelect.addEventListener("change", function () {
		newData = search()
		createEventList(newData)
	});

	dateSearchInput.addEventListener("change", function () {
			newData = search()
			createEventList(newData)
	});
	locationSearchInput.addEventListener("change", function () {
			newData = search()
			createEventList(newData)
	});
	function search()
	{
		newData = createEventListByCategory(categorySelect.value, data.events);
		console.log(newData)
		newData = createEventListByDate(dateSearchInput.value, newData);
		console.log(newData)
		newData = createEventListByLocation(locationSearchInput.value, newData);
		return newData

	}
</script>
</body>

</html>
